---
title: "Economy and institutions"
author: Luis Francisco Gomez Lopez
date: 2023-01-10 17:38:34
output:
  beamer_presentation:
    colortheme: dolphin
    fonttheme: structurebold
    theme: AnnArbor
  ioslides_presentation: default
  slidy_presentation: default
bibliography: intro_econ.bib
link-citations: yes
header-includes:
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage{fontawesome5}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo      = FALSE, 
                      warning   = FALSE, 
                      message   = FALSE,
                      fig.align = "center")
```

```{r }
library(DiagrammeR)
library(tidyverse)
library(wbstats)
library(tidyquant)
library(janitor)
library(ggrepel)
```

# Contents

- Please Read Me
- Purpose
- Definition of institutions
- Measuring formal institutions
- Regulation of business activity
- Crime
- Acknowledgments
- References

# Please Read Me

- Check the message __Welcome greeting__ published in the News Bulletin Board.

- Dear student please edit your profile uploading a photo where your face is clearly visible.

- The purpose of the virtual meetings is to answer questions and not to make a summary of the study material.

- This presentation is based on [@cardenas_introduccion_2020, Chapter 4]

# Purpose

Analyze the role of institutions in the economy

# Definition of institutions

- "Institutions are the rules of the game in a society or, more formally, are the humanly devised constraints that shape human interaction" [@north_institutions_1990, p 3]

- Institutions can be informal or formal [@north_institutions_1991]

    + **Informal**: sanctions,  taboos,  customs,  traditions,  and  codes  of conduct
    
    + **Formal**: constitutions, laws,  property right
    
# Measuring formal institutions

- Governance

    + Set of traditions and institutions by which authority in a country is exercised where it includes [@kaufmann_worldwide_2011, p 222]:
    
        + The process by which governments are selected, monitored and replaced
        + The capacity of the government to effectively formulate and implement sound policies
        + The respect of citizens and the state for the institutions that govern economic and social interactions among them
        
# Measuring formal institutions

- Governance dimensions [@kaufmann_worldwide_2011, p 223]

```{r out.width="150%"}

grViz("
digraph boxes_and_circles {

  graph [rankdir = LR]

  node [shape = circle, color = '#2C3E50']
 
  'Governance';

  node [shape = oval, color = '#E31A1C']

  'Process by which governments\nare selected, monitored, and\nreplaced';
  'Capacity of the government to\neffectively formulate and implement\nsound policies';
  'Respect of citizens and the state\nfor the institutions that govern economic and\nsocial interactions among them';
  
  node [shape = oval, color = '#18BC9C']
  
  'Voice and\nAccountability';
  'Political Stability and\nAbsence of Violence/Terrorism';
  'Government\neffectiveness';
  'Regulatory\nquality'
  'Rule of law'
  'Control of\ncorruption'
  
  'Governance' -> 'Process by which governments\nare selected, monitored, and\nreplaced';
  'Governance' -> 'Capacity of the government to\neffectively formulate and implement\nsound policies';
  'Governance' -> 'Respect of citizens and the state\nfor the institutions that govern economic and\nsocial interactions among them';
  
  'Process by which governments\nare selected, monitored, and\nreplaced' -> 'Voice and\nAccountability';
  'Process by which governments\nare selected, monitored, and\nreplaced' -> 'Political Stability and\nAbsence of Violence/Terrorism';
  'Capacity of the government to\neffectively formulate and implement\nsound policies' -> 'Government\neffectiveness';
  'Capacity of the government to\neffectively formulate and implement\nsound policies' -> 'Regulatory\nquality';
  'Respect of citizens and the state\nfor the institutions that govern economic and\nsocial interactions among them' -> 'Rule of law';
  'Respect of citizens and the state\nfor the institutions that govern economic and\nsocial interactions among them' -> 'Control of\ncorruption';
}
")
```

# Measuring formal institutions

- Where can I find data?

    + Worldwide Governance Indicators (WGI) - WorldBank
    
        + https://databank.worldbank.org/source/worldwide-governance-indicators
    
- What is the methodology?

    + https://info.worldbank.org/governance/wgi/ > Documentation

# Measuring formal institutions

```{r out.width = "90%"}
initial_year <- 1996
last_year <- 2021
middle_year <- ceiling((last_year - initial_year) / 2) + initial_year

# Percent Rank indicators
wgi_col_1996_2019 <- wbstats::wb_data(indicator = c(
                               # Voice and accountability
                               "VA.PER.RNK",
                               # Political Stability and Absence of Violence/Terrorism
                               "PV.PER.RNK",
                               # Government effectiveness
                               "GE.PER.RNK",
                               # Regulatory quality
                               "RQ.PER.RNK",
                               # Rule of law
                               "RL.PER.RNK",
                               # Control of Corruption
                               "CC.PER.RNK"),
                 country = "COL",
                 start_date = initial_year,
                 end_date = last_year,
                 return_wide = FALSE) %>%
  filter(date %in% c(initial_year, middle_year, last_year)) %>%
  mutate(indicator = str_replace(string = indicator,
                                 pattern = ": Percentile Rank",
                                 replacement = ""),
         indicator = ifelse(test = indicator == "Political Stability and Absence of Violence/Terrorism",
                            yes = "Political Stability and Absence\nof Violence/Terrorism",
                            no = indicator),
         indicator = fct_relevel(indicator,
                                 "Voice and Accountability",
                                 "Political Stability and Absence\nof Violence/Terrorism",
                                 "Government Effectiveness",
                                 "Regulatory Quality",
                                 "Rule of Law",
                                 "Control of Corruption") %>%
           fct_rev(),
         date = as.factor(date) %>% fct_rev())

wgi_col_1996_2019 %>%
  ggplot(aes(y = indicator, x = value, fill = date)) +
  geom_col(position = "dodge", color = "black") +
  geom_text(aes(label = round(value, digits = 2)),
            position = position_dodge(width = 1),
            hjust = -0.2) +
  scale_fill_tq() +
  guides(fill = guide_legend(reverse = TRUE)) +
  expand_limits(x = c(0, 70)) +
  labs(x = NULL,
       y = NULL,
       fill = NULL,
       title = "Governance dimensions for Colombia",
       subtitle = str_glue("All indicators are expressed as percentile ranks
                           Percentile rank indicates the country's rank among all countries covered by the aggregate indicator,
                           with 0 corresponding to lowest rank, and 100 to highest rank"),
       caption = str_glue("Source: Worldwide Governance Indicators (WGI) - World Bank
                          Last update: 2022-09-23")) +
  theme(panel.border    = element_rect(fill = NA, color = "black"),
        plot.background   = element_rect(fill = "#f3fcfc"),
        panel.background  = element_rect(fill = "#f3f7fc"),
        legend.background = element_rect(fill = "#f3fcfc"),
        legend.position   = "bottom",
        plot.title        = element_text(face = "bold"),
        axis.title        = element_text(face = "bold"),
        legend.title      = element_text(face = "bold"),
        axis.text         = element_text(face = "bold"))
```

# Regulation of business activity

\definecolor{tq_red}{RGB}{227, 26, 28}

- The report *Doing  Business*  analyzes  regulation  that  encourages  efficiency  and  supports  freedom  to  do  business [@world_bank_doing_2020, p 2]

- Where can I find data?

    + Doing Business - World Bank: 
    
        + https://www.doingbusiness.org/ > Explore Data Details > Select and economy: Colombia > Download Profile
        
        + https://databank.worldbank.org/source/doing-business
        
- What is the methodology?

    + https://www.doingbusiness.org/ > Methodology
    
- **\textcolor{tq_red}{Warning:} Investigation of Data Irregularities in  
Doing Business 2018 and Doing Business 2020** [@machen_investigation_2021]

# Regulation of business activity

\definecolor{tq_blue}{RGB}{44, 62, 80}
\definecolor{tq_steel_blue}{RGB}{166, 206, 227}
\definecolor{tq_navy_blue}{RGB}{31, 120, 180}

- Opening a business

    + \textcolor{tq_blue}{\faIcon{store-alt}} Starting a business
    
- Getting a location

    + \textcolor{tq_steel_blue}{\faIcon{tools}} Dealing with construction permits
    + \textcolor{tq_steel_blue}{\faIcon{bolt}} Getting electricity
    + \textcolor{tq_steel_blue}{\faIcon{city}} Registering property
    
- Accessing finance

    + \textcolor{tq_navy_blue}{\faIcon[regular]{credit-card}} Getting credit
    + \textcolor{tq_navy_blue}{\faIcon{user-shield}} Protecting minority investors
        
# Regulation of business activity

\definecolor{tq_light_green}{RGB}{178, 223, 138}
\definecolor{tq_orange}{RGB}{255, 127, 0}

- Dealing withday-to-day operations

    + \textcolor{tq_light_green}{\faIcon{file-invoice-dollar}} Paying taxes
    + \textcolor{tq_light_green}{\faIcon{truck-moving}} Trading across borders

- Operating in a secure business environment

    + \textcolor{tq_orange}{\faIcon{file-signature}} Enforcing contracts
    + \textcolor{tq_orange}{\faIcon{gavel}} Resolving insolvency
    
# Regulation of business activity

```{r out.width = "90%"}
initial_year <- 2020
last_year <- 2020

# Score indicators
db_col_2020 <- wbstats::wb_data(indicator = c(
                               # Starting a business
                               "IC.REG.STRT.BUS.DFRN",
                               # Dealing with construction permits
                               "IC.CNST.PRMT.DFRN.DB1619",
                               # Getting electricity
                               "IC.ELC.ACES.DFRN.DB1619",
                               # Registering property
                               "IC.REG.PRRT.DFRN.DB1719",
                               # Getting credit
                               "IC.CRED.ACC.CRD.DB1519.DFRN",
                               # Protecting minority investors
                               "PROT.MINOR.INV.DFRN.DB1519",
                               # Paying taxes,
                               "PAY.TAX.DB1719.DRFN",
                               # Trading across borders
                               "TRD.ACRS.BRDR.DB1619.DFRN",
                               # Enforcing contracts
                               "ENF.CONT.COEN.DB1719.DFRN",
                               # Resolving insolvency,
                               "RESLV.ISV.DB1519.DFRN"),
                 country = "COL",
                 start_date = initial_year,
                 end_date = last_year,
                 return_wide = FALSE) %>%
  mutate(indicator = str_replace(string = indicator,
                                 pattern = " - Score",
                                 replacement = ""),
         indicator = str_replace(string = indicator,
                                 pattern = r"(\(.*\))",
                                 replacement = ""),
         indicator = str_trim(string = indicator,
                              side = "both"),
         indicator = fct_relevel(indicator,
                                 "Starting a business",
                                 "Dealing with construction permits",
                                 "Getting electricity",
                                 "Registering property",
                                 "Getting credit",
                                 "Protecting minority investors",
                                 "Paying taxes",
                                 "Trading across borders",
                                 "Enforcing contracts",
                                 "Resolving insolvency") %>%
           fct_rev())

db_col_2020 %>%
  ggplot(aes(y = indicator, x = value)) +
  geom_col(aes(fill = indicator),
           position = "dodge", color = "black",
           show.legend = FALSE) +
  geom_text(aes(label = round(value, digits = 2)),
            position = position_dodge(width = 1),
            hjust = -0.2) +
  scale_fill_tq() +
  labs(x = NULL,
       y = NULL,
       title = "Doing business topics for Colombia in 2020",
       subtitle = str_glue("All indicators are expressed as scores
                           0 = lowest performance to 100 = best performance"),
       caption = str_glue("Source: Doing Business - World Bank
                          Last update: 2021-08-18")) +
  theme(panel.border    = element_rect(fill = NA, color = "black"),
        plot.background   = element_rect(fill = "#f3fcfc"),
        panel.background  = element_rect(fill = "#f3f7fc"),
        legend.background = element_rect(fill = "#f3fcfc"),
        legend.position   = "bottom",
        plot.title        = element_text(face = "bold"),
        axis.title        = element_text(face = "bold"),
        legend.title      = element_text(face = "bold"),
        axis.text         = element_text(face = "bold"))
```

# Crime

```{r out.width="90%"}
homicide_1990_2020 <- wbstats::wb_data(# Intentional homicides (per 100,000 people)
  indicator = "VC.IHR.PSRC.P5", 
  start_date = 1990, 
  end_date = 2020) %>% 
  filter(!is.na(VC.IHR.PSRC.P5), date %in% c(1990, 2020)) %>% 
  select(iso2c, iso3c, country, date, VC.IHR.PSRC.P5) %>% 
  pivot_wider(names_from = date, values_from = VC.IHR.PSRC.P5) %>% 
  drop_na()


homicide_1990_2020 %>% 
  ggplot(aes(x = `1990`, y = `2020`)) + 
  geom_abline(slope = 1, color = 'black') +
  geom_point(shape = 21, 
             size = 4,
             fill = "red") + 
  geom_label_repel(data = homicide_1990_2020 %>% 
                     filter(country == "Colombia"),
                   aes(label = country), 
                   seed = 1234,                    
                   box.padding = 1) + 
  scale_fill_tq() +
  labs(fill = NULL, 
       title = str_glue("Intentional homicides (per 100,000 people): 1990 vs 2020"),
                        subtitle = str_glue("Number of countries: {nrow(homicide_1990_2020)}"),
                        caption = str_glue("Source: World Development Indicators - World Bank
                          Last update: 2022-12-22")) + 
         theme(panel.border    = element_rect(fill = NA, color = "black"),
               plot.background   = element_rect(fill = "#f3fcfc"),
               panel.background  = element_rect(fill = "#f3f7fc"),
               legend.background = element_rect(fill = "#f3fcfc"),
               legend.position   = "bottom",
               plot.title        = element_text(face = "bold"),
               axis.title        = element_text(face = "bold"),
               legend.title      = element_text(face = "bold"),
               axis.text         = element_text(face = "bold"))
```

# Crime

```{r out.width="90%"}
homicide_female_1990_2020 <- wbstats::wb_data(
  # Intentional homicides, female (per 100,000 female)
  indicator = "VC.IHR.PSRC.FE.P5", 
  start_date = 1990, 
  end_date = 2020) %>% 
  filter(!is.na(VC.IHR.PSRC.FE.P5), date %in% c(1990, 2020)) %>% 
  select(iso2c, iso3c, country, date, VC.IHR.PSRC.FE.P5) %>% 
  pivot_wider(names_from = date, values_from = VC.IHR.PSRC.FE.P5) %>% 
  drop_na()

homicide_female_1990_2020 %>% 
  ggplot(aes(x = `1990`, y = `2020`)) + 
  geom_abline(slope = 1, color = 'black') +
  geom_point(shape = 21, 
             size = 4,
             fill = "red") + 
  geom_label_repel(data = homicide_female_1990_2020 %>% 
                     filter(country == "Colombia"),
                   aes(label = country), 
                   seed = 1234,                    
                   box.padding = 1) + 
  scale_fill_tq() +
  labs(fill = NULL, 
       title = "Intentional homicides, female (per 100,000 female): 1990 vs 2020",
       subtitle = str_glue("Number of countries: {nrow(homicide_female_1990_2020)}"),
       caption = str_glue("Source: World Development Indicators - World Bank
                          Last update: 2022-12-22")) + 
  theme(panel.border    = element_rect(fill = NA, color = "black"),
        plot.background   = element_rect(fill = "#f3fcfc"),
        panel.background  = element_rect(fill = "#f3f7fc"),
        legend.background = element_rect(fill = "#f3fcfc"),
        legend.position   = "bottom",
        plot.title        = element_text(face = "bold"),
        axis.title        = element_text(face = "bold"),
        legend.title      = element_text(face = "bold"),
        axis.text         = element_text(face = "bold"))
```

# Crime

```{r out.width="90%"}
homicide_male_1990_2020 <- wbstats::wb_data(
  # Intentional homicides, male (per 100,000 male)
  indicator = "VC.IHR.PSRC.MA.P5", 
  start_date = 1990, 
  end_date = 2020) %>% 
  filter(!is.na(VC.IHR.PSRC.MA.P5), date %in% c(1990, 2020)) %>% 
  select(iso2c, iso3c, country, date, VC.IHR.PSRC.MA.P5) %>% 
  pivot_wider(names_from = date, values_from = VC.IHR.PSRC.MA.P5) %>% 
  drop_na()

homicide_male_1990_2020 %>% 
  ggplot(aes(x = `1990`, y = `2020`)) + 
  geom_abline(slope = 1, color = 'black') +
  geom_point(shape = 21, 
             size = 4,
             fill = "red") + 
  geom_label_repel(data = homicide_male_1990_2020 %>% 
                     filter(country == "Colombia"),
                   aes(label = country), 
                   seed = 1234,                    
                   box.padding = 1) + 
  scale_fill_tq() +
  labs(fill = NULL, 
       title = "Intentional homicides, male (per 100,000 male): 1990 vs 2020",
       subtitle = str_glue("Number of countries: {nrow(homicide_female_1990_2020)}"),
       caption = str_glue("Source: World Development Indicators - World Bank
                          Last update: 2022-12-22")) + 
  theme(panel.border    = element_rect(fill = NA, color = "black"),
        plot.background   = element_rect(fill = "#f3fcfc"),
        panel.background  = element_rect(fill = "#f3f7fc"),
        legend.background = element_rect(fill = "#f3fcfc"),
        legend.position   = "bottom",
        plot.title        = element_text(face = "bold"),
        axis.title        = element_text(face = "bold"),
        legend.title      = element_text(face = "bold"),
        axis.text         = element_text(face = "bold"))
```

# Acknowledgments

- To my family that supports me

- To the taxpayers of Colombia and the __[UMNG students](https://www.umng.edu.co/estudiante)__ who pay my salary

- To the __[Business Science](https://www.business-science.io/)__ and __[R4DS Online Learning](https://www.rfordatasci.com/)__ communities where I learn __[R](https://www.r-project.org/about.html)__ 

- To the __[R Core Team](https://www.r-project.org/contributors.html)__, the creators of __[RStudio IDE](https://rstudio.com/products/rstudio/)__ and the authors and maintainers of the packages  __[DiagrammeR](https://CRAN.R-project.org/package=DiagrammeR)__, __[tidyverse](https://CRAN.R-project.org/package=tidyverse)__, __[wbstats](https://CRAN.R-project.org/package=wbstats)__, __[tidyquant](https://CRAN.R-project.org/package=tidyquant)__, __[janitor](https://CRAN.R-project.org/package=janitor)__, __[ggrepel](https://CRAN.R-project.org/package=ggrepel)__, and __[tinytex](https://CRAN.R-project.org/package=tinytex)__ for allowing me to access these tools without paying for a license

- To the __[Linux kernel community](https://www.kernel.org/category/about.html)__ for allowing me the possibility to use some __[Linux distributions](https://static.lwn.net/Distributions/)__ as my main __[OS](https://en.wikipedia.org/wiki/Operating_system)__ without paying for a license

# References {.allowframebreaks}
